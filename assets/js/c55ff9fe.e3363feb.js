"use strict";(self.webpackChunkfirmware_vault_docs=self.webpackChunkfirmware_vault_docs||[]).push([[462],{8998:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>i,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"Getting Started/debugdocker","title":"Debugging Docker Problems","description":"(Please note the Docker compose can take up to 20 minutes to build fresh)","source":"@site/docs/Getting Started/debugdocker.md","sourceDirName":"Getting Started","slug":"/Getting Started/debugdocker","permalink":"/firmware_vault_documentation/docs/Getting Started/debugdocker","draft":false,"unlisted":false,"editUrl":"https://gitlab.informatik.hs-augsburg.de/firmware-analysis/firmware_vault/docs/Getting Started/debugdocker.md","tags":[],"version":"current","frontMatter":{},"sidebar":"gettingStartedSidebar","previous":{"title":"Firmware Vault","permalink":"/firmware_vault_documentation/docs/Getting Started/How to use/firmware_vault"},"next":{"title":"Known TODOs","permalink":"/firmware_vault_documentation/docs/Getting Started/knowntodos"}}');var t=r(4848),l=r(8453);const a={},s="Debugging Docker Problems",i={},c=[{value:"Volumes are unable to find their folders",id:"volumes-are-unable-to-find-their-folders",level:2},{value:"My SQL DB container is in a restarting loop",id:"my-sql-db-container-is-in-a-restarting-loop",level:2},{value:"Clear everything from Docker",id:"clear-everything-from-docker",level:2},{value:"Stop all running containers",id:"stop-all-running-containers",level:3},{value:"Remove all containers",id:"remove-all-containers",level:3},{value:"Remove all images",id:"remove-all-images",level:3},{value:"Remove all volumes",id:"remove-all-volumes",level:3},{value:"Remove all networks (excluding the default ones)",id:"remove-all-networks-excluding-the-default-ones",level:3},{value:"Remove Docker build cache",id:"remove-docker-build-cache",level:3}];function d(e){const o={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"debugging-docker-problems",children:"Debugging Docker Problems"})}),"\n",(0,t.jsx)(o.p,{children:"(Please note the Docker compose can take up to 20 minutes to build fresh)"}),"\n",(0,t.jsx)(o.p,{children:"While Docker has a bunch of advantages, it can be incredibly frustrating to debug. Here are some issues we encountered and how we fixed them."}),"\n",(0,t.jsx)(o.h2,{id:"volumes-are-unable-to-find-their-folders",children:"Volumes are unable to find their folders"}),"\n",(0,t.jsx)(o.p,{children:'After calling "docker compose up," you might get an error that looks like this:'}),"\n",(0,t.jsxs)(o.p,{children:["Error response from daemon: error while mounting volume 'volume path in container/_data': failed to mount local volume: mount ",(0,t.jsx)(o.em,{children:"path to the project"}),"/docker_compose_dir/volumes/",(0,t.jsx)(o.em,{children:"one of the volumes"}),": volume path in container/_data, flags: 0x1000: no such file or directory"]}),"\n",(0,t.jsx)(o.p,{children:"In my case, this happened because once the Docker compose was run once, the volumes are created, and Docker will remember them permanently. If the location of the project directory changes, and with that the absolute paths to the folders of the volumes, you will get this error. Docker apparently does not realize that it is called from a different location and still tries to open the old folder locations."}),"\n",(0,t.jsx)(o.p,{children:"How to fix:"}),"\n",(0,t.jsx)(o.p,{children:"This command will delete all volumes from Docker so they can be rebuilt:\n!! If you have volumes from other projects, they will also be deleted !!"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker volume rm $(docker volume ls -q)\n"})}),"\n",(0,t.jsx)(o.h2,{id:"my-sql-db-container-is-in-a-restarting-loop",children:"My SQL DB container is in a restarting loop"}),"\n",(0,t.jsx)(o.p,{children:"This is probably caused because the mysql_data volume is not empty (and the data in it conflicts with the init.sql)."}),"\n",(0,t.jsx)(o.p,{children:"How to fix:\nDelete the contents of the /docker_compose_dir/volumes/mysql_data folder (hint: MySQL also creates hidden files)."}),"\n",(0,t.jsx)(o.p,{children:"If this does not work, also try to delete the volumes from Docker (so it can be rebuilt cleanly):"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker volume rm mysql_data\n"})}),"\n",(0,t.jsx)(o.h2,{id:"clear-everything-from-docker",children:"Clear everything from Docker"}),"\n",(0,t.jsx)(o.h3,{id:"stop-all-running-containers",children:"Stop all running containers"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker stop $(docker ps -aq)\n"})}),"\n",(0,t.jsx)(o.h3,{id:"remove-all-containers",children:"Remove all containers"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker rm $(docker ps -aq)\n"})}),"\n",(0,t.jsx)(o.h3,{id:"remove-all-images",children:"Remove all images"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker rmi $(docker images -q)\n"})}),"\n",(0,t.jsx)(o.h3,{id:"remove-all-volumes",children:"Remove all volumes"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker volume rm $(docker volume ls -q)\n"})}),"\n",(0,t.jsx)(o.h3,{id:"remove-all-networks-excluding-the-default-ones",children:"Remove all networks (excluding the default ones)"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker network rm $(docker network ls | grep -v \"bridge\\|host\\|none\" | awk '/ / { print $1 }')\n"})}),"\n",(0,t.jsx)(o.h3,{id:"remove-docker-build-cache",children:"Remove Docker build cache"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-sh",children:"docker builder prune -a\n"})})]})}function h(e={}){const{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,o,r)=>{r.d(o,{R:()=>a,x:()=>s});var n=r(6540);const t={},l=n.createContext(t);function a(e){const o=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),n.createElement(l.Provider,{value:o},e.children)}}}]);